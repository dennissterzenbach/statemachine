<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Dennis Sterzenbach - Senior JavaScript Developer</title>
    <link rel="stylesheet" type="text/css" href="longpager.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto">

    <!-- WebApp - default -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#ffffff">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
</head>

<body>
    <header class="stage" id="stage1">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/40/Sydney_Opera_House_Close_up_HDR_Sydney_Australia.jpg/1024px-Sydney_Opera_House_Close_up_HDR_Sydney_Australia.jpg" alt="1" />

        <input type="range" min="0" max="250" value="100" name="blurit" />
    </header>

    <script type="text/javascript">
        const blurInput = document.querySelector('input[name="blurit"]');
        blurInput.addEventListener('change', updateBlur);
        blurInput.addEventListener('mousemove', updateBlur);

        function updateBlur() {
            document.documentElement.style.setProperty('--blur', this.value/10 + 'px');
        }
    </script>

    <div class="wrap">
    <p id="navi">
        This is a elem....
    </p>
<p>
&nbsp;
</p>
<p>
&nbsp;
</p>
        <nav>
            <ul>
                <li><a data-state data-state-id="1" href="#section1">section1</a></li>
                <li><a data-state data-state-id="2" href="#section2">section2</a></li>
                <li><a data-state data-state-id="3" href="#section3">section3</a></li>
                <li><a data-state data-state-id="4" href="#section4">section4</a></li>
                <li><a data-state data-state-id="5" href="#section5">section5</a></li>
            </ul>
        </nav>

        <main class="sdhp2017--main flx-flexable-sections flx-flexable-sections__vertical flx-animate-anim1">
            <section class="some-section shadow-effect2 noise-section" id="section1">
                <h1>section1</h1>
                <div>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Officia suscipit, enim minus pariatur vitae eum reiciendis? Laborum quasi repudiandae ad aliquam, qui veniam ex ut at eveniet iste, facere sequi.</div>
                <div>Magni veniam cumque neque ipsum id in nihil, sapiente et harum consequuntur expedita ea unde nulla, nostrum pariatur nesciunt dolore soluta ipsa natus ratione asperiores, alias qui quidem eos! Veritatis?</div>
                <div>Praesentium, aliquam sed consequatur id sit, suscipit quidem. Eligendi officia beatae recusandae ipsa dolores libero aspernatur ab quasi facere repellendus, harum ex ducimus, non velit debitis. Doloremque aliquid doloribus nesciunt.</div>
                <div>Sapiente voluptas minus adipisci dolores veniam esse, saepe officia officiis, neque, exercitationem illum quia deserunt magnam ipsum quas delectus voluptatem debitis cumque animi molestias eaque odit ratione quo modi! Laborum!</div>
                <div>Explicabo eveniet laborum ex eaque commodi, magni dolor voluptatum fugiat cum esse fuga reiciendis vero expedita ad maxime quasi delectus repellat quo ipsam culpa voluptas, quisquam assumenda. Delectus, magnam cumque!</div>
                <div>Autem laborum, hic ex iure accusamus officia magnam nemo explicabo mollitia rerum vel architecto dignissimos, maiores totam quidem tempore eius perferendis. Architecto unde vel, deleniti soluta cumque sit molestias eius?</div>
                <div>Necessitatibus, cum iusto modi assumenda at quisquam sunt id nobis sapiente natus consequuntur dolores nulla blanditiis porro omnis, perspiciatis optio ut, quae quam officiis. Hic voluptatum quia nesciunt temporibus quisquam.</div>
                <div>Eius odio, sit asperiores vel quasi esse consectetur, facilis, quia ea explicabo voluptas aut laudantium debitis ullam facere dolores a pariatur dignissimos dolorum necessitatibus similique. Quae porro, reprehenderit labore exercitationem.</div>
                <div>Magnam, tempore pariatur autem quidem odio quibusdam sequi dolorum, odit debitis quod ducimus, expedita? Voluptatem, aspernatur quia, tempore unde accusamus explicabo cupiditate fugit error labore molestias dolorem. Error iure, repudiandae!</div>
                <div>Iusto, tempore neque cumque animi! Officiis facilis vitae alias, eius illo, minima maiores animi, veritatis et blanditiis a recusandae esse ab. Dolores accusamus a culpa nesciunt totam quis, voluptates! Ea!</div>
            </section>
            <section class="some-section shadow-effect2 noise-section" id="section2">
                <h1>section2</h1>
                <div>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Officia suscipit, enim minus pariatur vitae eum reiciendis? Laborum quasi repudiandae ad aliquam, qui veniam ex ut at eveniet iste, facere sequi.</div>
                <div>Magni veniam cumque neque ipsum id in nihil, sapiente et harum consequuntur expedita ea unde nulla, nostrum pariatur nesciunt dolore soluta ipsa natus ratione asperiores, alias qui quidem eos! Veritatis?</div>
                <div>Praesentium, aliquam sed consequatur id sit, suscipit quidem. Eligendi officia beatae recusandae ipsa dolores libero aspernatur ab quasi facere repellendus, harum ex ducimus, non velit debitis. Doloremque aliquid doloribus nesciunt.</div>
                <div>Sapiente voluptas minus adipisci dolores veniam esse, saepe officia officiis, neque, exercitationem illum quia deserunt magnam ipsum quas delectus voluptatem debitis cumque animi molestias eaque odit ratione quo modi! Laborum!</div>
            </section>
            <section class="some-section shadow-effect2 noise-section" id="section3">
                <h1>section3</h1>
                <div>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Officia suscipit, enim minus pariatur vitae eum reiciendis? Laborum quasi repudiandae ad aliquam, qui veniam ex ut at eveniet iste, facere sequi.</div>
                <div>Magni veniam cumque neque ipsum id in nihil, sapiente et harum consequuntur expedita ea unde nulla, nostrum pariatur nesciunt dolore soluta ipsa natus ratione asperiores, alias qui quidem eos! Veritatis?</div>
            </section>
            <section class="some-section shadow-effect2 noise-section" id="section4">
                <h1>section4</h1>
                <div>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Officia suscipit, enim minus pariatur vitae eum reiciendis? Laborum quasi repudiandae ad aliquam, qui veniam ex ut at eveniet iste, facere sequi.</div>
                <div>Magni veniam cumque neque ipsum id in nihil, sapiente et harum consequuntur expedita ea unde nulla, nostrum pariatur nesciunt dolore soluta ipsa natus ratione asperiores, alias qui quidem eos! Veritatis?</div>
                <div>Praesentium, aliquam sed consequatur id sit, suscipit quidem. Eligendi officia beatae recusandae ipsa dolores libero aspernatur ab quasi facere repellendus, harum ex ducimus, non velit debitis. Doloremque aliquid doloribus nesciunt.</div>
                <div>Sapiente voluptas minus adipisci dolores veniam esse, saepe officia officiis, neque, exercitationem illum quia deserunt magnam ipsum quas delectus voluptatem debitis cumque animi molestias eaque odit ratione quo modi! Laborum!</div>
            </section>
            <section class="some-section shadow-effect2 noise-section" id="section5">
                <h1>section5</h1>
                <div>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Officia suscipit, enim minus pariatur vitae eum reiciendis? Laborum quasi repudiandae ad aliquam, qui veniam ex ut at eveniet iste, facere sequi.</div>
                <div>Magni veniam cumque neque ipsum id in nihil, sapiente et harum consequuntur expedita ea unde nulla, nostrum pariatur nesciunt dolore soluta ipsa natus ratione asperiores, alias qui quidem eos! Veritatis?</div>
                <div>Praesentium, aliquam sed consequatur id sit, suscipit quidem. Eligendi officia beatae recusandae ipsa dolores libero aspernatur ab quasi facere repellendus, harum ex ducimus, non velit debitis. Doloremque aliquid doloribus nesciunt.</div>
                <div>Sapiente voluptas minus adipisci dolores veniam esse, saepe officia officiis, neque, exercitationem illum quia deserunt magnam ipsum quas delectus voluptatem debitis cumque animi molestias eaque odit ratione quo modi! Laborum!</div>
                <div>Explicabo eveniet laborum ex eaque commodi, magni dolor voluptatum fugiat cum esse fuga reiciendis vero expedita ad maxime quasi delectus repellat quo ipsam culpa voluptas, quisquam assumenda. Delectus, magnam cumque!</div>
                <div>Autem laborum, hic ex iure accusamus officia magnam nemo explicabo mollitia rerum vel architecto dignissimos, maiores totam quidem tempore eius perferendis. Architecto unde vel, deleniti soluta cumque sit molestias eius?</div>
                <div>Necessitatibus, cum iusto modi assumenda at quisquam sunt id nobis sapiente natus consequuntur dolores nulla blanditiis porro omnis, perspiciatis optio ut, quae quam officiis. Hic voluptatum quia nesciunt temporibus quisquam.</div>
                <div>Eius odio, sit asperiores vel quasi esse consectetur, facilis, quia ea explicabo voluptas aut laudantium debitis ullam facere dolores a pariatur dignissimos dolorum necessitatibus similique. Quae porro, reprehenderit labore exercitationem.</div>
                <div>Magnam, tempore pariatur autem quidem odio quibusdam sequi dolorum, odit debitis quod ducimus, expedita? Voluptatem, aspernatur quia, tempore unde accusamus explicabo cupiditate fugit error labore molestias dolorem. Error iure, repudiandae!</div>
                <div>Iusto, tempore neque cumque animi! Officiis facilis vitae alias, eius illo, minima maiores animi, veritatis et blanditiis a recusandae esse ab. Dolores accusamus a culpa nesciunt totam quis, voluptates! Ea!</div>
            </section>
        </main>
    </div>

    <script src="StateManager.js"></script>
    <script src="StateManager.Plugin.ActivateOnScroll.js"></script>

    <script>
        function applyIEPatch() {
            if (!_.has(window, 'console')) {
                window.console = {};
            }

            if (!_.isFunction(window.console.log)) {
                window.console.log = function() {};
            }

            if (!_.isFunction(window.console.debug)) {
                window.console.debug = function() {};
            }

            if (!_.isFunction(window.console.info)) {
                window.console.info = function() {};
            }

            if (!_.isFunction(window.console.table)) {
                window.console.table = function() {};
            }
        }
    </script>

    <script>
        function queryElement(selector) {
            return document.querySelector(selector);
        }

        var stateMgr = new StateManager();
        stateMgr.registerState(new State('section1', '1', queryElement('#section1')));
        stateMgr.registerState(new State('section2', '2', queryElement('#section2')));
        stateMgr.registerState(new State('section3', '3', queryElement('#section3')));
        stateMgr.registerState(new State('section4', '4', queryElement('#section4')));
        stateMgr.registerState(new State('section5', '5', queryElement('#section5')));

        stateMgr.getRegisteredState('section1').onActivatedCallbacks.push(wasActivated);
        stateMgr.getRegisteredState('section2').onActivatedCallbacks.push(wasActivated);
        stateMgr.getRegisteredState('section3').onActivatedCallbacks.push(wasActivated);
        stateMgr.getRegisteredState('section4').onActivatedCallbacks.push(wasActivated);
        stateMgr.getRegisteredState('section5').onActivatedCallbacks.push(wasActivated);

        stateMgr.initialize();
        stateMgr.disableScrollbasedActivationFn = stateMgr.enableActivateStateOnScroll(true);

        function wasActivated(state) {
            console.log('state was activated (callback)', state.name);

            // markSectionsNavItemActive(state);
        }

        function MainNavigationManager() {
            this.naviActiveItemClass = 'nav--item__is-active';
        }

        MainNavigationManager.prototype.init = function init() {
            this.registerListeners();
        };

        MainNavigationManager.prototype.updateURLWithActivatedState = function updateURLWithActivatedState(activatedState) {
            // console.debug('updateURLWithActivatedState');

            var hash = '#' + activatedState.name;
            
            if (history.pushState) {
                history.pushState(null, null, hash);
            } else {
                window.location.hash = hash;
            }
        };

        MainNavigationManager.prototype.getAllNavigationItems = function getAllNavigationItems() {
            return document.querySelectorAll('nav>ul>li>a');
        };

        MainNavigationManager.prototype.registerListeners = function registerListeners() {
            this.getAllNavigationItems().forEach(addEventListeners.bind(this));

            function addEventListeners(linkEl) {
                linkEl.addEventListener('click', this.activateStateFromEvent.bind(this));

                // add callback to the registered state (if available)
                // so that an activation of that state within stateManager will
                // also cause an update on navigation
                var regState = stateMgr.getRegisteredState(this.getNameForStateId(this.getStateIdFromNavItem(linkEl)));

                if (regState) {
                    regState.onActivatedCallbacks.push(this.updateNavigationItemsAccordingToActivatedState.bind(this));
                }

                // console.log('RegNaviHandlers >>>', regState, linkEl);
            }
        };

        MainNavigationManager.prototype.updateNavigationItemsAccordingToActivatedState = function updateNavigationItemsAccordingToActivatedState(activatedState) {
            if (activatedState && activatedState.id) {
                var allNaviItems = this.getAllNavigationItems();

                // update style of the navigation items according to the activated state
                if (allNaviItems) {
                    allNaviItems.forEach(function(linkEl) {
                        if (this.getStateIdFromNavItem(linkEl) === activatedState.id) {
                            linkEl.classList.add(this.naviActiveItemClass);
                        } else {
                            linkEl.classList.remove(this.naviActiveItemClass);
                        }
                    }.bind(this));
                }

                // in addition to updating the style on the user interface,
                // also update the URL with the matching anchor.
                // this enables us to point the user to the correct state again
                // when he reloads the page or bookmarks it and wants to 
                // deeplink into it later again.
                this.updateURLWithActivatedState(activatedState);
            }
        };

        MainNavigationManager.prototype.getNameForStateId = function getNameForStateId(stateId) {
            return 'section' + stateId;
        };

        MainNavigationManager.prototype.getStateIdFromNavItem = function getStateIdFromNavItem(item) {
            return item && item.attributes && item.attributes.getNamedItem('data-state-id').value;
        };

        MainNavigationManager.prototype.activateStateFromEvent = function activateStateFromEvent(e) {
            this.activateStateById(this.getStateIdFromNavItem(e.target));
        };

        MainNavigationManager.prototype.activateStateById = function activateStateById(id) {
            var name = this.getNameForStateId(id);

            console.log(';;', name);
            stateMgr.activateState(name);
        };

        var navMgr = new MainNavigationManager();
        navMgr.init();
    </script>

    <script type="text/javascript">
        function AnimateIn() {
            this.element = document.getElementById('navi');
            this.element.style.position = 'absolute';

            this.start = null;
        }

        AnimateIn.prototype.startAnimating = function startAnimating() {
            this.continueAnimating();
        };

        AnimateIn.prototype.continueAnimating = function continueAnimating() {
            window.requestAnimationFrame(this.animate.bind(this));
        };

        AnimateIn.prototype.animate = function animate(timestamp) {
            this.start = this.start || timestamp;

            let progress = timestamp - this.start;
            let position = Math.min(progress / 2, 500);
            let degrees = Math.min(progress / 2.5, 360);

            this.element.style.left = position + 'px';
            this.element.style.transform = `rotate(${degrees}deg)`;

            if ((progress >= 3800) || (degrees === 360 && position === 500)) {
                // console.debug('finished');
            } else {
                this.continueAnimating();
            }
        };

        var animator = new AnimateIn();
        animator.startAnimating();
    </script>

    <footer>
        <p>
            &copy; Copyright 2015 - 2017 Dennis Sterzenbach.
        </p>
    </footer>
</body>
</html>
